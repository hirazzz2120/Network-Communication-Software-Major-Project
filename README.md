# SIP é€šä¿¡ç³»ç»Ÿ

> åŸºäº JAIN SIP + Spring Boot + JavaFX çš„å³æ—¶é€šä¿¡ç³»ç»Ÿ

## é¡¹ç›®ç®€ä»‹

å®Œæ•´çš„ SIP é€šä¿¡ç³»ç»Ÿï¼Œæ”¯æŒå³æ—¶æ¶ˆæ¯ã€è¯­éŸ³é€šè¯å’Œæ–‡ä»¶ä¼ è¾“ï¼Œå¸¦æœ‰å®æ—¶ Web ç›‘æ§é¢æ¿ã€‚

**ç³»ç»Ÿæ¶æ„ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Java å®¢æˆ·ç«¯    â”‚ â†â”€SIPâ”€â†’ â”‚   MSS SIP æœåŠ¡å™¨  â”‚
â”‚  (sip-client)   â”‚         â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ HTTP (æ–‡ä»¶/æ•°æ®åŒæ­¥)
         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä¸šåŠ¡æœåŠ¡å™¨       â”‚  â† æµè§ˆå™¨è®¿é—® Dashboard
â”‚  (admin-server) â”‚     http://localhost:8081
â”‚  - æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½  â”‚
â”‚  - ç”¨æˆ·/æ¶ˆæ¯ç®¡ç†  â”‚
â”‚  - å®æ—¶ç›‘æ§é¢æ¿  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æŠ€æœ¯æ ˆ

| æ¨¡å— | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| æ„å»ºå·¥å…· | Maven | 3.x |
| JDK | OpenJDK | 17 |
| SIP åè®® | JAIN SIP RI | 1.3.0-91 |
| æœåŠ¡ç«¯ | Spring Boot | 3.2.5 |
| å®¢æˆ·ç«¯ UI | JavaFX | 21.0.1 |
| æœ¬åœ°å­˜å‚¨ | SQLite | 3.45.0.0 |
| æœåŠ¡ç«¯æ•°æ®åº“ | H2 (æ–‡ä»¶æ¨¡å¼) | å†…ç½® |

## æ ¸å¿ƒåŠŸèƒ½

### âœ… å·²å®Œæˆ
- **SIP åè®®**ï¼šæ³¨å†Œã€æ¶ˆæ¯ã€å‘¼å«
- **å³æ—¶æ¶ˆæ¯**ï¼šç±»å¾®ä¿¡æ°”æ³¡ç•Œé¢
- **è¯­éŸ³é€šè¯**ï¼šSIP ä¿¡ä»¤
- **æ–‡ä»¶ä¼ è¾“**ï¼šå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ã€é€šç”¨æ–‡ä»¶ï¼ˆHTTP ä¸Šä¼  + SIP é“¾æ¥ï¼‰
- **è”ç³»äººç®¡ç†**ï¼šå¢åˆ æ”¹æŸ¥ã€æœç´¢
- **æœ¬åœ°å­˜å‚¨**ï¼šSQLite æ¶ˆæ¯å†å²
- **è®¾ç½®ç•Œé¢**ï¼šé€šçŸ¥ã€éŸ³é‡ã€è‡ªåŠ¨ä¿å­˜
- **Web ç›‘æ§é¢æ¿**ï¼šå®æ—¶æŸ¥çœ‹ç”¨æˆ·ã€æ¶ˆæ¯ã€é€šè¯è®°å½•
- **æ•°æ®åŒæ­¥**ï¼šç™»å½•/ç¦»çº¿çŠ¶æ€ã€æ¶ˆæ¯è®°å½•è‡ªåŠ¨åŒæ­¥åˆ°åç«¯

### ğŸ”„ å¼€å‘ä¸­
- RTP éŸ³é¢‘ä¼ è¾“
- ç¾¤èŠåŠŸèƒ½
- æ–­ç‚¹ç»­ä¼ 

---

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- JDK 17+
- Maven 3.x

### ğŸš€ å¯åŠ¨æ­¥éª¤

> âš ï¸ **æ–‡ä»¶ä¼ è¾“å’Œæ•°æ®åŒæ­¥åŠŸèƒ½éœ€è¦å…ˆå¯åŠ¨ admin-server**

**1. å¯åŠ¨ä¸šåŠ¡æœåŠ¡å™¨**
```powershell
cd admin-server
mvn spring-boot:run
```
ç­‰å¾…çœ‹åˆ° `Started AdminServerApplication`ï¼ŒæœåŠ¡è¿è¡Œåœ¨ `http://localhost:8081`

**2. æ‰“å¼€ç›‘æ§é¢æ¿ï¼ˆå¯é€‰ï¼‰**

æµè§ˆå™¨è®¿é—® [http://localhost:8081](http://localhost:8081) æŸ¥çœ‹å®æ—¶ç›‘æ§é¢æ¿ã€‚

**3. å¯åŠ¨ GUI å®¢æˆ·ç«¯ï¼ˆæ–°å¼€ç»ˆç«¯çª—å£ï¼‰**
```powershell
.\start-gui.ps1
```

**4. ç™»å½•**
- è¾“å…¥ç”¨æˆ· IDï¼ˆå¦‚ 101ï¼‰
- SIP æœåŠ¡å™¨åœ°å€ï¼ˆé»˜è®¤ 10.29.133.174:5060ï¼‰
- ç‚¹å‡»ç™»å½•

---

## Web ç›‘æ§é¢æ¿

è®¿é—® `http://localhost:8081` å¯å®æ—¶æŸ¥çœ‹ï¼š

| æ¨¡å— | è¯´æ˜ |
|------|------|
| ç»Ÿè®¡æ¦‚è§ˆ | æ€»ç”¨æˆ·æ•°ã€åœ¨çº¿ç”¨æˆ·ã€é€šè¯æ¬¡æ•°ã€ä»Šæ—¥æ¶ˆæ¯ |
| ç”¨æˆ·åˆ—è¡¨ | æ‰€æœ‰ç™»å½•è¿‡çš„ç”¨æˆ·åŠåœ¨çº¿çŠ¶æ€ |
| æ¶ˆæ¯è®°å½• | æœ€è¿‘å‘é€çš„æ¶ˆæ¯ï¼ˆå‘é€è€…ã€æ¥æ”¶è€…ã€å†…å®¹ã€æ—¶é—´ï¼‰ |
| é€šè¯è®°å½• | å†å²é€šè¯ä¿¡æ¯ |

> ğŸ’¡ æ•°æ®æ¯ 10 ç§’è‡ªåŠ¨åˆ·æ–°ï¼Œä¹Ÿå¯æ‰‹åŠ¨ç‚¹å‡»"åˆ·æ–°æ•°æ®"æŒ‰é’®ã€‚

---

## æ–‡ä»¶ä¼ è¾“

### æ”¯æŒç±»å‹

| ç±»å‹ | å¤§å°é™åˆ¶ | æ ¼å¼ |
|------|---------|------|
| å›¾ç‰‡ | 10MB | jpg, png, gif, bmp, webp |
| éŸ³é¢‘ | 5MB | wav, mp3, m4a, aac |
| è§†é¢‘ | 50MB | mp4, avi, mov, mkv |
| æ–‡ä»¶ | 20MB | ä»»æ„ |

### ä½¿ç”¨æ–¹æ³•
1. é€‰æ‹©è”ç³»äºº
2. ç‚¹å‡» ğŸ“ æˆ–ç›¸åº”æŒ‰é’®é€‰æ‹©æ–‡ä»¶
3. æ–‡ä»¶è‡ªåŠ¨ä¸Šä¼ å¹¶å‘é€é“¾æ¥ç»™å¯¹æ–¹

### å±€åŸŸç½‘é…ç½®

å¦‚éœ€å±€åŸŸç½‘å†…ä¸ä»–äººäº’ä¼ æ–‡ä»¶ï¼Œä¿®æ”¹ä»¥ä¸‹ä¸¤å¤„çš„ IP åœ°å€ï¼š

1. `sip-client/.../file/FileTransferService.java`
   ```java
   private String serverUrl = "http://ä½ çš„IP:8081";
   ```

2. `admin-server/.../controller/FileController.java`
   ```java
   String downloadUrl = String.format("http://ä½ çš„IP:%d/api/files/download/%s", ...);
   ```

---

## æ•°æ®å­˜å‚¨

### æœåŠ¡ç«¯æ•°æ®ï¼ˆadmin-serverï¼‰
- **æ•°æ®åº“**ï¼šH2 æ–‡ä»¶æ•°æ®åº“
- **ä½ç½®**ï¼š`admin-server/data/sipdb.mv.db`
- **ç‰¹æ€§**ï¼šé‡å¯åæ•°æ®ä¿ç•™

### å®¢æˆ·ç«¯æ•°æ®ï¼ˆsip-clientï¼‰
- **æ•°æ®åº“**ï¼šSQLite
- **ä½ç½®**ï¼šé¡¹ç›®æ ¹ç›®å½• `sip_client.db`
- **å†…å®¹**ï¼šæœ¬åœ°èŠå¤©è®°å½•ã€è”ç³»äººä¿¡æ¯

---

## é¡¹ç›®ç»“æ„

```
Project/
â”œâ”€â”€ pom.xml                    # çˆ¶ POM
â”œâ”€â”€ start-gui.ps1              # GUI å¯åŠ¨è„šæœ¬
â”œâ”€â”€ start-sip-user101.ps1      # å‘½ä»¤è¡Œå¯åŠ¨è„šæœ¬
â”œâ”€â”€ start-sip-user102.ps1
â”‚
â”œâ”€â”€ sip-client/                # å®¢æˆ·ç«¯æ¨¡å—
â”‚   â””â”€â”€ src/main/java/.../
â”‚       â”œâ”€â”€ api/               # Admin Server å®¢æˆ·ç«¯
â”‚       â”œâ”€â”€ sip/               # SIP åè®®å±‚
â”‚       â”œâ”€â”€ call/              # å‘¼å«ç®¡ç†
â”‚       â”œâ”€â”€ chat/              # æ¶ˆæ¯å¤„ç†
â”‚       â”œâ”€â”€ file/              # æ–‡ä»¶ä¼ è¾“æœåŠ¡
â”‚       â””â”€â”€ gui/               # JavaFX ç•Œé¢
â”‚           â”œâ”€â”€ controller/    # æ§åˆ¶å™¨
â”‚           â”œâ”€â”€ model/         # æ•°æ®æ¨¡å‹
â”‚           â””â”€â”€ storage/       # æœ¬åœ°å­˜å‚¨
â”‚
â””â”€â”€ admin-server/              # æœåŠ¡å™¨æ¨¡å—
    â”œâ”€â”€ data/                  # H2 æ•°æ®åº“æ–‡ä»¶
    â””â”€â”€ src/
        â”œâ”€â”€ main/java/.../
        â”‚   â”œâ”€â”€ controller/    # REST API
        â”‚   â”‚   â”œâ”€â”€ FileController    # æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½
        â”‚   â”‚   â”œâ”€â”€ AuthController    # è®¤è¯
        â”‚   â”‚   â”œâ”€â”€ UserController    # ç”¨æˆ·ç®¡ç†
        â”‚   â”‚   â”œâ”€â”€ MessageController # æ¶ˆæ¯ç®¡ç†
        â”‚   â”‚   â””â”€â”€ DashboardController # ç›‘æ§é¢æ¿
        â”‚   â”œâ”€â”€ entity/        # æ•°æ®æ¨¡å‹
        â”‚   â”œâ”€â”€ service/       # ä¸šåŠ¡é€»è¾‘
        â”‚   â””â”€â”€ repository/    # æ•°æ®è®¿é—®
        â””â”€â”€ main/resources/
            â”œâ”€â”€ static/        # Web å‰ç«¯ï¼ˆDashboardï¼‰
            â””â”€â”€ application.properties
```

---

## API æ¥å£

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/dashboard` | GET | è·å–ç›‘æ§é¢æ¿æ•°æ® |
| `/api/users` | GET | è·å–ç”¨æˆ·åˆ—è¡¨ |
| `/api/users/offline` | POST | è®¾ç½®ç”¨æˆ·ç¦»çº¿ |
| `/api/auth/login` | POST | ç”¨æˆ·ç™»å½•åŒæ­¥ |
| `/api/messages/send` | POST | è®°å½•æ¶ˆæ¯ |
| `/api/files/upload` | POST | ä¸Šä¼ æ–‡ä»¶ |
| `/api/files/download/{id}` | GET | ä¸‹è½½æ–‡ä»¶ |

---

## å¸¸è§é—®é¢˜

**Q: æ–‡ä»¶å‘é€å¤±è´¥ï¼Œæ˜¾ç¤º"ç¼–ç ä¸­"åæŠ¥é”™ï¼Ÿ**  
A: ç¡®ä¿ admin-server å·²å¯åŠ¨ä¸”å¯è®¿é—®ã€‚

**Q: å±€åŸŸç½‘å…¶ä»–äººæ— æ³•æ¥æ”¶æ–‡ä»¶ï¼Ÿ**  
A: æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ 8081 ç«¯å£ï¼Œç¡®è®¤ IP åœ°å€é…ç½®æ­£ç¡®ã€‚

**Q: èŠå¤©è®°å½•ä¿å­˜åœ¨å“ªï¼Ÿ**  
A: é¡¹ç›®æ ¹ç›®å½•çš„ `sip_client.db`ï¼ˆSQLiteï¼‰ã€‚

**Q: å¦‚ä½•æ›´æ¢ SIP æœåŠ¡å™¨ï¼Ÿ**  
A: ç™»å½•ç•Œé¢ç›´æ¥ä¿®æ”¹ SIP URIã€‚

**Q: Dashboard æ˜¾ç¤º"æ— æ³•åŠ è½½"ï¼Ÿ**  
A: é‡å¯ admin-serverï¼Œç¡®ä¿ 8081 ç«¯å£å¯è®¿é—®ã€‚

**Q: ç”¨æˆ·ç¦»çº¿çŠ¶æ€æ²¡æ›´æ–°ï¼Ÿ**  
A: ç¡®ä¿æ­£å¸¸å…³é—­å®¢æˆ·ç«¯ï¼ˆç‚¹å‡»çª—å£ X æŒ‰é’®ï¼‰ï¼Œè€Œä¸æ˜¯å¼ºåˆ¶ç»ˆæ­¢è¿›ç¨‹ã€‚

---

## è®¸å¯è¯

æœ¬é¡¹ç›®ç”¨äºè¯¾ç¨‹å­¦ä¹ å’ŒæŠ€æœ¯ç ”ç©¶ã€‚
